<!DOCTYPE html>
<html manifest="manifest.appcache">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Hacker News</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" href="icons/favicon.ico">
<link rel="apple-touch-icon-precomposed" href="icons/touch-icon.png">
<script>
var _gaq = [['_setAccount', 'UA-23235796-3'], ['_trackPageview']];
if (location.hostname == 'cheeaun.github.com'){
	(function(d, t){
		var g = d.createElement(t), s = d.getElementsByTagName(t)[0];
		g.src = ('https:' == d.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		s.parentNode.insertBefore(g, s);
	}(document, 'script'));
	window.Muscula = {
		settings:{
			logId:"21f74a59-9317-4924-8c73-9ab4718cd49b", branding: 'none'
		}
	};
	(function(){
		var m = document.createElement('script'); m.type = 'text/javascript'; m.async = true;
		m.src = (window.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//musculahq.appspot.com/Muscula.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(m, s);
		window.Muscula.run = function(c){ eval(c); window.Muscula.run = function(){}; };
	})();
}

(function(d, ua){
	var theme = 'web';
	if (ua && /iPhone|iPod|iPad/.test(ua) && parseInt((ua.match(/ OS (\d+)_/i) || [,0])[1], 10) >= 5){
		theme = 'ios';
	}

	var head = d.head || d.getElementsByTagName('head')[0];

	var link = d.createElement('link');
	link.rel = 'stylesheet';
	link.href = 'css/hn-' + theme + '.css';
	head.appendChild(link);

	var scripts = ['scripts', 'scripts-' + theme, 'templates', 'hn', 'hn-' + theme];
	if ('async' in d.createElement('script')){
		for (var i=0, l=scripts.length; i<l; i++){
			var script = d.createElement('script');
			script.async = false;
			script.src = 'js/' + scripts[i] + '.js';
			head.appendChild(script);
		}
	} else {
		var i = 0, l = scripts.length;
		var injectScript = function(){
			if (i == l) return;
			var script = d.createElement('script');
			script.src = 'js/' + scripts[i++] + '.js';
			script.onload = injectScript;
			setTimeout(function(){
				head.appendChild(script);
			}, 1);
		};
		injectScript();
	}
})(document, navigator.userAgent);

if (window.applicationCache){
	// "Naturally" reload when an update is available
	var reload = false;
	window.applicationCache.addEventListener('updateready', function(){
		if (window.applicationCache.status == window.applicationCache.UPDATEREADY){
			window.applicationCache.swapCache();
			reload = true;
		}
	}, false);

	setInterval(function(){
		try { // There's nothing to update for first-time load, browser freaks out :/
			window.applicationCache.update();
		} catch (e){}
	}, 1000*60*60); // Every hour

	var checkReload = function(){
		if (reload) location.reload();
	};
	window.addEventListener('pageshow', checkReload, false);
	window.addEventListener('focus', checkReload, false);

	// Use GA to track the update rate of this manifest appcache thing
	// and see how fast users are updated to the latest cache/version
	if (typeof _gaq != 'undefined') window.addEventListener('load', function(){
		setTimeout(function(){
			var r = new XMLHttpRequest();
			r.open('GET', 'manifest.appcache', true);
			r.onload = function(){
				var text = this.responseText;
				if (!text) return;
				var version = (text.match(/#\s\d[^\n\r]+/) || [])[0];
				if (version) _gaq.push(['_trackEvent', 'Appcache', 'Version', version.replace(/^#\s/, '')]);
			};
			r.send();
		}, 1000);
	}, false);
}
</script>
</head>
<body>
<!--[if lt IE 9]>
	<p id="outdated-browser">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> to better experience this site.</p>
<![endif]-->
<div id="apploader"></div>
<div class="view hidden" id="view-home">
	<header>
		<a href="#/about" class="header-button header-button-left"><button>About</button></a>
		<h1 style="margin: 0 65px;">Hacker News</h1>
		<a class="header-button header-button-icon header-button-right" id="view-home-refresh"><button><i class="icon-refresh">Refresh</i></button></a>
	</header>
	<div class="scroll">
		<section>
		</section>
	</div>
</div>
<div class="view hidden" id="view-comments">
	<header>
		<a href="#/" class="header-button header-button-left header-back-button"><button>News</button></a>
		<h1 style="margin: 0 65px;"></h1>
	</header>
	<div class="scroll">
		<section>
		</section>
	</div>
</div>
<div class="view hidden" id="view-about">
	<header>
		<a href="#/" class="header-button header-button-left"><button>Close</button></a>
		<h1>About</h1>
	</header>
	<div class="scroll striped">
		<section>
			<div class="grouped-tableview cf">
				<span id="y-icon"></span>
				<p id="app-desc">The unofficial Hacker News mobile web app, specially designed to look and feel like a native app on iOS devices, and magically falls back to a simple web app for other devices.</p>
			</div>
			<ul class="grouped-tableview grouped-tableview-links">
				<li><a href="http://news.ycombinator.com/" target="_blank" class="disclosure">Hacker News official site</a></li>
				<li><a href="https://github.com/cheeaun/hnmobile" target="_blank" class="disclosure">GitHub Project</a></li>
				<li><a href="https://twitter.com/cheeaun" target="_blank" class="disclosure">@cheeaun</a></li>
				<li><a href="mailto:cheeaun+hnmobile@gmail.com?subject=HNmobile feedback" class="disclosure">Email</a></li>
			</ul>
			<p class="foot-label">Built by Lim Chee Aun.<br>Not affiliated with Hacker News or YCombinator.</p>
		</section>
	</div>
</div>
</body>
</html>