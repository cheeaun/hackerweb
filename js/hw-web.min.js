!function(a){var b=[],c=function(){},d={defaultPath:"/",before:c,on:c,notfound:c},e={current:null,previous:null,config:function(a){for(var b in a)a.hasOwnProperty(b)&&(d[b]=a[b]);return e},add:function(a,c,d){return a&&c&&("function"==typeof c&&(d=c,c=null),b.push({path:a,name:c,fn:d||function(){}})),e},go:function(a){return location.hash=a,e},back:function(a){return e.previous?(history.back(),e.previous=null):a&&(location.hash=a),e}},f=function(){var a=location.hash.slice(1),c=!1,f=e.current;a||(a=d.defaultPath),f&&f!=e.previous&&(e.previous=f),e.current=a;
for(var g=0,h=b.length;h>g&&!c;g++){var i=b[g],j=i.path,k=i.name,l=i.fn;if("string"==typeof j)j.toLowerCase()==a.toLowerCase()&&(d.before.call(e,j,k),l.call(e),d.on.call(e,j,k),c=!0);else{var m=a.match(j);m&&(d.before.call(e,j,k,m),l.apply(e,m),d.on.call(e,j,k,m),c=!0)}}return c||d.notfound.call(e),e};e.init=function(){return a.addEventListener("hashchange",f),f()},e.reload=f,a.ruto=e}(window),function(a,b){function c(a,c){d.addType(a,function(f,g,h){var i,j,k,l,m=g,n=(new Date).getTime();if(!f){m={},l=[],k=0;
try{for(f=c.length;f=c.key(k++);)e.test(f)&&(j=JSON.parse(c.getItem(f)),j.expires&&j.expires<=n?l.push(f):m[f.replace(e,"")]=j.data);for(;f=l.pop();)c.removeItem(f)}catch(o){}return m}if(f="__amplify__"+f,g===b){if(i=c.getItem(f),j=i?JSON.parse(i):{expires:-1},!(j.expires&&j.expires<=n))return j.data;c.removeItem(f)}else if(null===g)c.removeItem(f);else{j=JSON.stringify({data:g,expires:h.expires?n+h.expires:null});try{c.setItem(f,j)}catch(o){d[a]();try{c.setItem(f,j)}catch(o){throw d.error()}}}return m
})}var d=a.store=function(a,b,c){var e=d.type;return c&&c.type&&c.type in d.types&&(e=c.type),d.types[e](a,b,c||{})};d.types={},d.type=null,d.addType=function(a,b){d.type||(d.type=a),d.types[a]=b,d[a]=function(b,c,e){return e=e||{},e.type=a,d(b,c,e)}},d.error=function(){return"amplify.store quota exceeded"};var e=/^__amplify__/;for(var f in{localStorage:1,sessionStorage:1})try{window[f].setItem("__amplify__","x"),window[f].removeItem("__amplify__"),c(f,window[f])}catch(g){}if(!d.types.localStorage&&window.globalStorage)try{c("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===d.type&&(d.type="globalStorage")
}catch(g){}!function(){if(!d.types.localStorage){var a=document.createElement("div"),c="amplify";a.style.display="none",document.getElementsByTagName("head")[0].appendChild(a);try{a.addBehavior("#default#userdata"),a.load(c)}catch(e){return void a.parentNode.removeChild(a)}d.addType("userData",function(e,f,g){a.load(c);var h,i,j,k,l,m=f,n=(new Date).getTime();if(!e){for(m={},l=[],k=0;h=a.XMLDocument.documentElement.attributes[k++];)i=JSON.parse(h.value),i.expires&&i.expires<=n?l.push(h.name):m[h.name]=i.data;
for(;e=l.pop();)a.removeAttribute(e);return a.save(c),m}if(e=e.replace(/[^\-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-"),e=e.replace(/^-/,"_-"),f===b){if(h=a.getAttribute(e),i=h?JSON.parse(h):{expires:-1},!(i.expires&&i.expires<=n))return i.data;a.removeAttribute(e)}else null===f?a.removeAttribute(e):(j=a.getAttribute(e),i=JSON.stringify({data:f,expires:g.expires?n+g.expires:null}),a.setAttribute(e,i));try{a.save(c)}catch(o){null===j?a.removeAttribute(e):a.setAttribute(e,j),d.userData();
try{a.setAttribute(e,i),a.save(c)}catch(o){throw null===j?a.removeAttribute(e):a.setAttribute(e,j),d.error()}}return m})}}(),function(){function a(a){return a===b?b:JSON.parse(JSON.stringify(a))}var c={},e={};d.addType("memory",function(d,f,g){return d?f===b?a(c[d]):(e[d]&&(clearTimeout(e[d]),delete e[d]),null===f?(delete c[d],null):(c[d]=f,g.expires&&(e[d]=setTimeout(function(){delete c[d],delete e[d]},g.expires)),f)):a(c)})}()}(this.amplify=this.amplify||{});var Hogan={};!function(a,b){function c(a,b,c){var d;
return b&&"object"==typeof b&&(null!=b[a]?d=b[a]:c&&b.get&&"function"==typeof b.get&&(d=b.get(a))),d}function d(a,b,c,d,e,f){function g(){}function h(){}g.prototype=a,h.prototype=a.subs;var i,j=new g;j.subs=new h,j.subsText={},j.ib(),d=d||{},j.stackSubs=d;for(i in b)d[i]||(d[i]=b[i]),j.subsText[i]=f;for(i in d)j.subs[i]=d[i];e=e||{},j.stackPartials=e;for(i in c)e[i]||(e[i]=c[i]);for(i in e)j.partials[i]=e[i];return j}function e(a){return String(null===a||void 0===a?"":a)}function f(a){return a=e(a),l.test(a)?a.replace(g,"&amp;").replace(h,"&lt;").replace(i,"&gt;").replace(j,"&#39;").replace(k,"&quot;"):a
}a.Template=function(a,b,c,d){a=a||{},this.r=a.code||this.r,this.c=c,this.options=d||{},this.text=b||"",this.partials=a.partials||{},this.subs=a.subs||{},this.ib()},a.Template.prototype={r:function(){return""},v:f,t:e,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},ep:function(a,b){var c=this.partials[a],e=b[c.name];if(c.instance&&c.base==e)return c.instance;if("string"==typeof e){if(!this.c)throw new Error("No compiler available.");e=this.c.compile(e,this.options)
}return e?(this.partials[a].base=e,c.subs&&(void 0===this.activeSub&&(b.stackText=this.text),e=d(e,c.subs,c.partials,this.stackSubs,this.stackPartials,b.stackText||this.text)),this.partials[a].instance=e,e):null},rp:function(a,b,c,d){var e=this.ep(a,c);return e?e.ri(b,c,d):""},rs:function(a,b,c){var d=a[a.length-1];if(!m(d))return void c(a,b,this);for(var e=0;e<d.length;e++)a.push(d[e]),c(a,b,this),a.pop()},s:function(a,b,c,d,e,f,g){var h;return m(a)&&0===a.length?!1:("function"==typeof a&&(a=this.ms(a,b,c,d,e,f,g)),h=!!a,!d&&h&&b&&b.push("object"==typeof a?a:b[b.length-1]),h)
},d:function(a,b,d,e){var f,g=a.split("."),h=this.f(g[0],b,d,e),i=this.options.modelGet,j=null;if("."===a&&m(b[b.length-2]))h=b[b.length-1];else for(var k=1;k<g.length;k++)f=c(g[k],h,i),null!=f?(j=h,h=f):h="";return e&&!h?!1:(e||"function"!=typeof h||(b.push(j),h=this.mv(h,b,d),b.pop()),h)},f:function(a,b,d,e){for(var f=!1,g=null,h=!1,i=this.options.modelGet,j=b.length-1;j>=0;j--)if(g=b[j],f=c(a,g,i),null!=f){h=!0;break}return h?(e||"function"!=typeof f||(f=this.mv(f,b,d)),f):e?!1:""},ls:function(a,b,c,d,f){var g=this.options.delimiters;
return this.options.delimiters=f,this.b(this.ct(e(a.call(b,d)),b,c)),this.options.delimiters=g,!1},ct:function(a,b,c){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(a,this.options).render(b,c)},b:b?function(a){this.buf.push(a)}:function(a){this.buf+=a},fl:b?function(){var a=this.buf.join("");return this.buf=[],a}:function(){var a=this.buf;return this.buf="",a},ib:function(){this.buf=b?[]:""},ms:function(a,b,c,d,e,f,g){var h,i=b[b.length-1],j=a.call(i);
return"function"==typeof j?d?!0:(h=this.activeSub&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(j,i,c,h.substring(e,f),g)):j},mv:function(a,b,c){var d=b[b.length-1],f=a.call(d);return"function"==typeof f?this.ct(e(f.call(d)),d,c):f},sub:function(a,b,c,d){var e=this.subs[a];e&&(this.activeSub=a,e(b,c,this,d),this.activeSub=!1)}};var g=/&/g,h=/</g,i=/>/g,j=/\'/g,k=/\"/g,l=/[&<>\"\']/,m=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)
}}("undefined"!=typeof exports?exports:Hogan),function(a){var b=function(){return+new Date},c=!!a.XDomainRequest,d="withCredentials"in new XMLHttpRequest||c,e=!1,f=2e4,g={};try{e=new Worker("js/hnapi-worker.js"),e.addEventListener("message",function(a){var b=a.data,c=b.url||"";if(g[c]){var d=g[c],e=d.error,f=d.success;delete g[c],b.error?e(b.error):f(b.response)}},!1)}catch(h){}var i=function(h,i,j){if(i||(i=function(){}),j||(j=function(){}),d)if(e)g[h]={success:i,error:j},e.postMessage({url:h,timeout:f});
else{var k=g[h]||(c?new XDomainRequest:new XMLHttpRequest);k._timeout&&clearTimeout(k._timeout),k._timeout=setTimeout(function(){k.abort()},f),k.onload=function(){clearTimeout(this._timeout),delete g[h];try{i(JSON.parse(this.responseText))}catch(a){j(a)}},k.onerror=k.onabort=k.ontimeout=function(a){clearTimeout(this._timeout),delete g[h],j(a)},(k.readyState<=1||c)&&(k.open("GET",h+"?"+b(),!0),k.send()),g[h]=k}else{var l=a.document,m=l.createElement("script"),n="callback"+b();a[n]=i,m.onerror=j,m.src=h+"?callback="+n,l.body.appendChild(m)
}},j=["//node-hnapi-eu.herokuapp.com/","//node-hnapi.azurewebsites.net/","//node-hnapi-asia.azurewebsites.net/","//node-hnapi-eus.azurewebsites.net/","//node-hnapi-weu.azurewebsites.net/","//node-hnapi-wus.azurewebsites.net/","//node-hnapi-ncus.azurewebsites.net/"],k=function(a){for(var b=a.length-1;b>0;b--){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}};k(j);var l=j.length,m=function(a,b,c,d){var e=l-1>a?function(){m(a+1,b,c,d)}:d;i(j[a]+b,c,e)},n=function(a,b,c){i(j[0]+a,b,function(){m(0,a,b,c)
})},o={urls:j,news:function(a,b){n("news",a,b)},news2:function(a,b){n("news2",a,b)},item:function(a,b,c){n("item/"+a,b,c)},comments:function(a,b,c){n("comments/"+a,b,c)}};a.hnapi=o}(window),function(a){var b=a.document,c=function(a,c){var d=b.documentElement,e=d.matchesSelector||d.mozMatchesSelector||d.webkitMatchesSelector||d.oMatchesSelector||d.msMatchesSelector;return e.call(a,c)},d=function(a,b){var d=!1;do d=c(a,b);while(!d&&(a=a.parentNode)&&a.ownerDocument);return d?a:!1};a.ibento=function(a,c,e){var f=b.body;
f.addEventListener(c,function(b){var c=d(b.target,a);c&&e.call(f,b,c)})}}(window),"document"in self&&!("classList"in document.createElement("_"))&&!function(a){"use strict";if("Element"in a){var b="classList",c="prototype",d=a.Element[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");
if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){for(var b=f.call(a.getAttribute("class")||""),c=b?b.split(/\s+/):[],d=0,e=c.length;e>d;d++)this.push(c[d]);this._updateClassName=function(){a.setAttribute("class",this.toString())}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",-1!==i(this,a)},k.add=function(){var a,b=arguments,c=0,d=b.length,e=!1;
do a=b[c]+"",-1===i(this,a)&&(this.push(a),e=!0);while(++c<d);e&&this._updateClassName()},k.remove=function(){var a,b=arguments,c=0,d=b.length,e=!1;do{a=b[c]+"";var f=i(this,a);-1!==f&&(this.splice(f,1),e=!0)}while(++c<d);e&&this._updateClassName()},k.toggle=function(a,b){a+="";var c=this.contains(a),d=c?b!==!0&&"remove":b!==!1&&"add";return d&&this[d](a),!c},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){-2146823252===n.number&&(m.enumerable=!1,e.defineProperty(d,b,m))
}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}}(self),function(a){TEMPLATES={"comments-toggle":new a({code:function(a,b,c){var d=this;return d.b(c=c||""),d.b('<button class="comments-toggle">'),d.b(d.v(d.f("comments_count",a,b,0))),d.b(" "),d.b(d.v(d.f("i_reply",a,b,0))),d.b("</button>"),d.fl()},partials:{},subs:{}}),comments:new a({code:function(a,b,c){var d=this;return d.b(c=c||""),d.s(d.f("comments",a,b,1),a,b,0,13,202,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<li><p class="metadata"><b class="user">'),c.b(c.v(c.f("user",a,b,0))),c.b('</b> <time><a href="#" data-id="'),c.b(c.v(c.f("id",a,b,0))),c.b('" class="comment-permalink">'),c.b(c.v(c.f("time_ago",a,b,0))),c.b("</a></time></p><p>"),c.b(c.t(c.f("content",a,b,0))),c.b("<ul>"),c.b(c.rp("<comments_list0",a,b,"")),c.b("</ul></li>")
}),a.pop()),d.fl()},partials:{"<comments_list0":{name:"comments_list",partials:{},subs:{}}},subs:{}}),"post-comments":new a({code:function(a,b,c){var d=this;return d.b(c=c||""),d.b('<div class="post-content">'),d.s(d.f("has_post",a,b,1),a,b,0,39,577,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<header><h1><a href="'),c.b(c.v(c.f("url",a,b,0))),c.b('" target="_blank">'),c.b(c.v(c.f("title",a,b,0))),c.b("<br>"),c.s(c.f("user",a,b,1),a,b,0,107,170,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.s(c.f("domain",a,b,1),a,b,0,118,159,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b('<span class="link-text">'),c.b(c.v(c.f("domain",a,b,0))),c.b("</span>")
}),a.pop())}),a.pop()),c.b('</a></h1><p class="metadata">'),c.s(c.f("user",a,b,1),a,b,0,217,412,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b('<span class="inline-block">'),c.b(c.v(c.f("points",a,b,0))),c.b(" "),c.b(c.v(c.f("i_point",a,b,0))),c.b(" by "),c.b(c.v(c.f("user",a,b,0))),c.b('</span> <span class="inline-block">'),c.b(c.v(c.f("time_ago",a,b,0))),c.s(c.f("comments_count",a,b,1),a,b,0,344,386,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b(" &middot; "),c.b(c.v(c.f("comments_count",a,b,0))),c.b(" "),c.b(c.v(c.f("i_comment",a,b,0)))
}),a.pop()),c.b("</span>")}),a.pop()),c.s(c.f("user",a,b,1),a,b,1,0,0,"")||(c.b('<span class="inline-block">'),c.b(c.v(c.f("time_ago",a,b,0))),c.b("</span>")),c.b('<a href="'),c.b(c.v(c.f("hn_url",a,b,0))),c.b('" target="_blank" class="external-link">'),c.b(c.v(c.f("short_hn_url",a,b,0))),c.b("</a></p></header>")}),a.pop()),d.s(d.f("has_content",a,b,1),a,b,0,606,929,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<section class="grouped-tableview">'),c.b(c.t(c.f("content",a,b,0))),c.s(c.f("has_poll",a,b,1),a,b,0,667,906,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b('<ul class="poll">'),c.s(c.f("poll",a,b,1),a,b,0,693,892,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b('<li title="'),c.b(c.v(c.f("percentage",a,b,0))),c.b('%"><span class="poll-details"><b>'),c.b(c.v(c.f("item",a,b,0))),c.b('</b> <span class="points">'),c.b(c.v(c.f("points",a,b,0))),c.b(" "),c.b(c.v(c.f("i_point",a,b,0))),c.b('</span></span><div class="poll-bar"><span style="width: '),c.b(c.v(c.f("width",a,b,0))),c.b('"></span></div></li>')
}),a.pop()),c.b("</ul>")}),a.pop()),c.b("</section>")}),a.pop()),d.b('</div><section class="comments">'),d.s(d.f("loading",a,b,1),a,b,0,989,1059,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<div class="loader"><i class="icon-loading"></i> Loading&hellip;</div>')}),a.pop()),d.s(d.f("load_error",a,b,1),a,b,0,1086,1169,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<div class="load-error">Couldn\'t load comments.<br><button>Try again</button></div>')}),a.pop()),d.s(d.f("loading",a,b,1),a,b,1,0,0,"")||d.s(d.f("load_error",a,b,1),a,b,1,0,0,"")||(d.s(d.f("has_comments",a,b,1),a,b,0,1228,1255,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b("<ul>"),c.b(c.rp("<comments_list0",a,b,"")),c.b("</ul>")
}),a.pop()),d.s(d.f("has_comments",a,b,1),a,b,1,0,0,"")||d.b('<p class="no-comments">No comments.</p>')),d.b("</section>"),d.fl()},partials:{"<comments_list0":{name:"comments_list",partials:{},subs:{}}},subs:{}}),post:new a({code:function(a,b,c){var d=this;return d.b(c=c||""),d.b('<li id="story-'),d.b(d.v(d.f("id",a,b,0))),d.b('" data-index="'),d.b(d.v(d.f("i",a,b,0))),d.b('" class="post-'),d.b(d.v(d.f("type",a,b,0))),d.b('"><a href="'),d.b(d.v(d.f("url",a,b,0))),d.b('" class="'),d.s(d.f("detail_disclosure",a,b,1),a,b,0,110,127,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b("detail-disclosure")
}),a.pop()),d.s(d.f("disclosure",a,b,1),a,b,0,164,174,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b("disclosure")}),a.pop()),d.b(" "),d.s(d.f("selected",a,b,1),a,b,0,203,211,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b("selected")}),a.pop()),d.b('"><div class="number">'),d.b(d.v(d.f("i",a,b,0))),d.b('</div><div class="story"><b>'),d.b(d.v(d.f("title",a,b,0))),d.b("</b>"),d.s(d.f("user",a,b,1),a,b,0,301,593,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<span class="metadata">'),c.s(c.f("domain",a,b,1),a,b,0,335,380,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b('<span class="link-text">'),c.b(c.v(c.f("domain",a,b,0))),c.b("</span><br>")
}),a.pop()),c.b('<span class="inline-block">'),c.b(c.v(c.f("points",a,b,0))),c.b(" "),c.b(c.v(c.f("i_point",a,b,0))),c.b(" by "),c.b(c.v(c.f("user",a,b,0))),c.b('</span> <span class="inline-block">'),c.b(c.v(c.f("time_ago",a,b,0))),c.s(c.f("comments_count",a,b,1),a,b,0,518,560,"{{ }}")&&(c.rs(a,b,function(a,b,c){c.b(" &middot; "),c.b(c.v(c.f("comments_count",a,b,0))),c.b(" "),c.b(c.v(c.f("i_comment",a,b,0)))}),a.pop()),c.b("</span></span>")}),a.pop()),d.s(d.f("user",a,b,1),a,b,1,0,0,"")||(d.b('<span class="metadata">'),d.s(d.f("domain",a,b,1),a,b,0,645,690,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<span class="link-text">'),c.b(c.v(c.f("domain",a,b,0))),c.b("</span><br>")
}),a.pop()),d.b('<span class="inline-block">'),d.b(d.v(d.f("time_ago",a,b,0))),d.b("</span></span>")),d.b("</div></a>"),d.s(d.f("detail_disclosure",a,b,1),a,b,0,795,869,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<a href="#/item/'),c.b(c.v(c.f("id",a,b,0))),c.b('" class="detail-disclosure-button"><span></span></a>')}),a.pop()),d.b("</li>"),d.fl()},partials:{},subs:{}}),"stories-load":new a({code:function(a,b,c){var d=this;return d.b(c=c||""),d.s(d.f("loading",a,b,1),a,b,0,12,82,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<div class="loader"><i class="icon-loading"></i> Loading&hellip;</div>')
}),a.pop()),d.s(d.f("load_error",a,b,1),a,b,0,109,161,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('<div class="load-error">Couldn\'t load stories.</div>')}),a.pop()),d.fl()},partials:{},subs:{}})}}(Hogan.Template),function(a){var b=a.document,c=a.$=function(a){return b.getElementById(a)},d={},e=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},f={pub:function(a,b){var c=d[a];if(c)for(var e=0,f=c.length;f>e;e++)c[e].call(this,b)},sub:function(a,b){d[a]||(d[a]=[]),d[a].push(b)
},currentView:null,hideAllViews:function(){for(var a=b.querySelectorAll(".view"),c=0,d=a.length;d>c;c++)a[c].classList.add("hidden")},tmpl:function(a,b){var c=TEMPLATES[a];if(c)return b?c.render(b):c},setTitle:function(a){var b="HackerWeb";a&&(a=a.replace(/^\s+|\s+$/g,""),a.toLowerCase()!=b.toLowerCase()&&(b=a+" â€“ "+b)),document.title=b}};"undefined"!=typeof ga&&f.sub("logAPIError",function(a){ga("send","event","Errors","API",a)});var g=f.tmpl;amplify.store.sessionStorage&&"function"==typeof amplify.store.sessionStorage||(amplify.store.sessionStorage=amplify.store.memory);
var h=b.createElement("a"),i={},j=function(a){var b=i[a];if(b)return b;h.href=a;var c=h.hostname.replace(/^www\./,""),d=h.pathname.replace(/^\//,"").split("/")[0],e=d.length,f=c.length<=25&&e>3&&15>=e&&/^[^0-9][^.]+$/.test(d)?"/"+d:"";return b=c+f},k=b.querySelector("#view-home .scroll"),l=k.querySelector("section"),m=!1;f.news={options:{disclosure:!0},markupStory:function(a){return/^item/i.test(a.url)?a.url="#/item/"+a.id:(a.external=!0,a.domain=j(a.url)),f.news.options.disclosure?("link"==a.type&&(a.detail_disclosure=!0),/^#\//.test(a.url)&&(a.disclosure=!0,a.domain=null)):a.id&&(a.url="#/item/"+a.id),a.i_point=1==a.points?"point":"points",a.i_comment=1==a.comments_count?"comment":"comments",g("post",a)
},markupStories:function(a,b){var c="";b||(b=1);var d=f.news.markupStory;return a.forEach(function(a){a.i=b++,c+=d(a)}),c},updateStory:function(a){if(a&&a.id){var b,d=a.id,e=a.data,g="hacker-news",h=amplify.store(g);if(h)for(var i=0,j=h.length;j>i;i++){var k=h[i];if(d==k.id){b=k;break}}if(!b&&(g="hacker-news2",h=amplify.store(g)))for(var i=0,j=h.length;j>i;i++){var k=h[i];if(d==k.id){b=k;break}}if(b){var l=!1;if(["title","url","time_ago","comments_count","points"].forEach(function(a){var c=e[a];b[a]!=c&&(b[a]=c,l=!0)
}),l){amplify.store(g,h);var m=c("story-"+d);m&&(b.selected=!!m.querySelector("a[href].selected"),b.i=m.dataset?m.dataset.index:m.getAttribute("data-index"),m.insertAdjacentHTML("afterend",f.news.markupStory(b)),m.parentNode.removeChild(m))}}}},render:function(a){if(!m){a||(a={});var b=amplify.store("hacker-news-cached"),d=g("stories-load"),e=function(a){var b=a.slice(),c='<ul class="tableview tableview-links" id="hwlist">'+f.news.markupStories(b)+(amplify.store("hacker-news2")?'<li><a class="more-link">More&hellip;<span class="loader"><i class="icon-loading"></i></span></a></li>':"")+"</ul>";
l.innerHTML=c,f.pub("onRenderNews")};if(b){var h=amplify.store("hacker-news"),i=a.delay;i?(m=!0,l.innerHTML=d.render({loading:!0}),setTimeout(function(){m=!1,e(h)},i)):e(h)}else{m=!0,l.innerHTML=d.render({loading:!0});var j=function(){l.innerHTML=d.render({load_error:!0}),f.pub("logAPIError","news")};hnapi.news(function(a){return m=!1,!a||a.error?void j():(amplify.store("hacker-news",a),amplify.store("hacker-news-cached",!0,{expires:6e5}),amplify.store("hacker-news2",null),e(a),void hnapi.news2(function(a){a&&!a.error&&(amplify.store("hacker-news2",a),c("hwlist").insertAdjacentHTML("beforeend",'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>'))
}))},function(){m=!1,j()})}}},reload:function(){f.news.render({delay:300})},more:function(a){a.classList.add("loading");var b=amplify.store("hacker-news2");setTimeout(function(){a.classList.remove("loading");var d=a.parentNode;if(d&&(d.parentNode&&d.parentNode.removeChild(d),b)){var e=b.slice(),g=f.news.markupStories(e,31);c("hwlist").insertAdjacentHTML("beforeend",g)}},400)}};var n=c("view-comments"),o=n.querySelector("header h1"),p=n.querySelector("section");f.comments={currentID:null,render:function(a){if(a){var c=amplify.store.sessionStorage("hacker-item-"+a);
if(f.comments.currentID!=a||!c){f.comments.currentID=a;var d=function(a,b){if(a&&!a.error){var c=e(a);amplify.store.sessionStorage("hacker-comments-"+b,c);var d=p.querySelector(".comments>ul");if(d.querySelector(".more-link-container")||d.insertAdjacentHTML("beforeend",'<li class="more-link-container"><a class="more-link" data-id="'+b+'">More&hellip;</a></li>'),c.more_comments_id){var f=function(a){var b=amplify.store.sessionStorage("hacker-comments-"+a);b?b.more_comments_id&&f(b.more_comments_id):hnapi.comments(a,function(b){b&&!b.error&&(amplify.store.sessionStorage("hacker-comments-"+a,b),b.more_comments_id&&f(b.more_comments_id))
})};f(c.more_comments_id)}}},h=function(a,c){var h=e(a),i=g("post-comments");if(h.has_post=!!h.title,!h.has_post)return f.setTitle(),o.innerHTML="",p.innerHTML=i.render(h),f.pub("adjustCommentsSection"),void f.pub("onRenderComments");var k=g("comments");if(/^item/i.test(h.url)?h.url="//news.ycombinator.com/"+h.url:h.domain=j(h.url),h.has_comments=h.comments&&!!h.comments.length,h.i_point=1==h.points?"point":"points",h.i_comment=1==h.comments_count?"comment":"comments",h.has_content=!!h.content,h.poll){var l=0,m=0;
h.poll.forEach(function(a){var b=a.points;b>m&&(m=b),l+=b,a.i_point=1==b?"point":"points"}),h.poll.forEach(function(a){var b=a.points;a.percentage=(b/l*100).toFixed(1),a.width=(b/m*100).toFixed(1)+"%"}),h.has_poll=h.has_content=!0}h.short_hn_url="news.ycombinator.com/item?id="+c,h.hn_url="//"+h.short_hn_url,f.setTitle(h.title),o.innerHTML=h.title;var n=i.render(h,{comments_list:k}),q=b.createElement("div");q.innerHTML=n;for(var r=q.querySelectorAll("a"),s=0,t=r.length;t>s;s++){var u=r[s];if(u.classList.contains("comment-permalink")){var c=u.dataset?u.dataset.id:u.getAttribute("data-id");
u.href="//news.ycombinator.com/item?id="+c}u.target="_blank"}var v=h.user;if(v)for(var w=q.querySelectorAll(".user"),s=0,t=w.length;t>s;s++){var x=w[s];x.textContent.trim()==v&&(x.classList.add("op"),x.title="Original Poster")}if(n.length>2e4)for(var y=q.querySelectorAll(".comments>ul>li>ul"),z=g("comments-toggle"),A=0,t=y.length;t>A;A++){var B=y[A],C=B.querySelectorAll(".metadata").length;B.style.display="none",C&&B.insertAdjacentHTML("beforebegin",z.render({comments_count:C,i_reply:1==C?"reply":"replies"}))
}for(;p.hasChildNodes();)p.removeChild(p.childNodes[0]);for(;q.hasChildNodes();)p.appendChild(q.childNodes[0]);if(delete q,h.more_comments_id){var c=h.more_comments_id,D=amplify.store.sessionStorage("hacker-comments-"+c);D?d(D,c):hnapi.comments(c,function(a){d(a,c)})}f.pub("onRenderComments")};if(c)p.scrollTop=0,h(c,a);else{var i=amplify.store("hacker-news");if(i)for(var k=0,l=i.length;l>k;k++){var m=i[k];if(a==m.id){c=m;break}}if(!c){var i=amplify.store("hacker-news2");if(i)for(var k=0,l=i.length;l>k;k++){var m=i[k];
if(a==m.id){c=m;break}}}c?(c.loading=!0,h(c,a)):h({loading:!0},a);var n=function(){c?(delete c.loading,c.load_error=!0,h(c,a)):h({load_error:!0},a),f.pub("logAPIError","comments")};hnapi.item(a,function(b){if(f.comments.currentID==a){if(!b||b.error&&"comments"==f.currentView)return void n();amplify.store.sessionStorage("hacker-item-"+a,b,{expires:3e5}),f.news.updateStory({id:a,data:b}),h(b,a)}},function(){f.comments.currentID==a&&n()})}}}},toggle:function(a){var b=a.nextElementSibling;if(b){var c=b.style,d=p.scrollTop;
c.display="none"==c.display?"":"none",p.scrollTop=d}},more:function(a){var c=a.dataset?a.dataset.id:a.getAttribute("data-id"),d=amplify.store.sessionStorage("hacker-comments-"+c);if(d){var e=g("comments"),f=g("comments"),h=e.render(d,{comments_list:e}),i=a.parentNode,j=i.parentNode,k=d.more_comments_id,l=b.createElement("ul");l.innerHTML=h;for(var m=l.querySelectorAll("a"),n=0,o=m.length;o>n;n++)m[n].target="_blank";for(var p=l.children,n=0,o=p.length;o>n;n++){var q=p[n].getElementsByTagName("ul")[0],r=q.querySelectorAll(".metadata").length;
q.style.display="none",r&&q.insertAdjacentHTML("beforebegin",f.render({comments_count:r,i_reply:1==r?"reply":"replies"}))}for(k&&amplify.store.sessionStorage("hacker-comments-"+k)&&l.insertAdjacentHTML("beforeend",'<li class="more-link-container"><a class="more-link" data-id="'+k+'">More&hellip;</a></li>'),j.removeChild(i);l.hasChildNodes();)j.appendChild(l.childNodes[0]);delete l}else alert("Oops, the comments have expired.")},reload:function(){f.comments.currentID=null,ruto.reload()}},f.init=function(){f.news.render(),ruto.init()
},a.hw=f,ruto.config({before:function(a,b){f.hideAllViews();var d=c("view-"+b);d.classList.remove("hidden"),f.currentView=b,f.setTitle(d.querySelector("header h1").textContent)},notfound:function(){ruto.go("/")}}).add("/","home").add("/about","about").add(/^\/item\/(\d+)$/i,"comments",function(a,b){f.comments.render(b)})}(window),function(a){if(a.addEventListener){var b,c=a.document,d=(c.body,{}),e=function(){return a.pageYOffset||"CSS1Compat"===c.compatMode&&c.documentElement.scrollTop||0},f=function(){var a=location.hash.slice(1),b=d[a]=e(),c="hacker-scrolltop-"+a;
amplify.store.sessionStorage(c,b)};a.addEventListener("scroll",function(){clearTimeout(b),b=setTimeout(f,500)},!1),ruto.config({on:function(){var b=location.hash.slice(1),c="hacker-scrolltop-"+b,f=amplify.store.sessionStorage(c);a.scrollTo(0,d[b]||f||0),f=d[b]=e(),amplify.store.sessionStorage(c,f)}});var g=c.head||c.getElementsByTagName("head")[0],h=function(){var b=a.innerHeight,d=$("view-height");d||(d=c.createElement("style"),d.id="view-height",g.appendChild(d)),a.innerWidth>=788&&(b*=.9),d.textContent=".view>.scroll{min-height: "+b+"px}"
};if(a.addEventListener("resize",h,!1),a.addEventListener("orientationchange",h,!1),h(),ibento("#view-home-refresh","click",hw.news.reload),ibento("#view-home .more-link","click",function(a,b){hw.news.more(b)}),ibento("button.comments-toggle","click",function(a,b){hw.comments.toggle(b)}),ibento("section.comments li>a.more-link","click",function(a,b){hw.comments.more(b)}),ibento("#view-comments .load-error button","click",hw.comments.reload),/Mobile;.*Firefox/.test(navigator.userAgent)&&navigator.mozApps){var i=navigator.mozApps.getSelf();
i.onsuccess=function(){i.result&&ibento('a[href]:not([href^="#"])',"click",function(a,b){a.preventDefault(),window.open(b.href,"browser")})}}window.onload=hw.init}}(window);
//# sourceMappingURL=hw-web.min.map